

#include "mttp.h"






void mppt(int *dutyCycle, float *power, float *prevPower) {
	const int deltaDuty = 10;    // Incremento o decremento del Duty Cycle
	if (*power > *prevPower) {
		if (*dutyCycle < 255)
			*dutyCycle += deltaDuty; // Si la potencia ha aumentado, continuar ajustando en la misma dirección
	} else {
		if (*dutyCycle > 0)
			*dutyCycle -= deltaDuty; // Si la potencia ha disminuido, invertir la dirección del ajuste
	}

	if (*dutyCycle < 0)
		*dutyCycle = 0; // Asegurar que el Duty Cycle esté dentro de los límites permitidos (0-255)
	if (*dutyCycle > 255)
		*dutyCycle = 255;

	*prevPower = *power; // Actualizar `prevPower` con el valor actual de `power`
}
